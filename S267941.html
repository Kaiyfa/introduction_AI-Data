<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>

















<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Introduction to AI and Data Science Assessment<a rel="noopener" class="anchor-link" href="#Introduction-to-AI-and-Data-Science-Assessment">&#182;</a></h1>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>1) Task 1: Search Problems<a rel="noopener" class="anchor-link" href="#1)-Task-1:-Search-Problems">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a) Define the search problem<a rel="noopener" class="anchor-link" href="#a)-Define-the-search-problem">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Represent the map structure as a graph using a dictionary where the keys are city names and the values are dictionaries of connected cites with their respective distances.
The goal state is defined, to find the least distance route from Ipswich to Newcastle.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[128]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Represent the map structure as a graph</span>

<span class="c1"># Add the necessary packages</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">heapq</span>


<span class="c1"># Define the map as a graph</span>

<span class="n">city_graph</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Bristol&quot;</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="s2">&quot;Cambridge&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span> <span class="s2">&quot;Liverpool&quot;</span><span class="p">:</span> <span class="mi">151</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="mi">189</span><span class="p">,</span> <span class="s2">&quot;Manchester&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span> <span class="s2">&quot;Sheffield&quot;</span><span class="p">:</span> <span class="mi">119</span><span class="p">},</span>
    <span class="s2">&quot;Bristol&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="mi">190</span><span class="p">},</span>
    <span class="s2">&quot;Cambridge&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">:</span> <span class="mi">87</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="mi">89</span><span class="p">,</span> <span class="s2">&quot;Norwich&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">},</span>
    <span class="s2">&quot;Ipswich&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Cambridge&quot;</span><span class="p">:</span> <span class="mi">87</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="s2">&quot;Norwich&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">},</span>
    <span class="s2">&quot;Leeds&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Manchester&quot;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span> <span class="s2">&quot;Sheffield&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">:</span> <span class="mi">160</span><span class="p">},</span>
    <span class="s2">&quot;Liverpool&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">151</span><span class="p">,</span> <span class="s2">&quot;Manchester&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">},</span>
    <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">189</span><span class="p">,</span> <span class="s2">&quot;Bristol&quot;</span><span class="p">:</span> <span class="mi">190</span><span class="p">,</span> <span class="s2">&quot;Cambridge&quot;</span><span class="p">:</span> <span class="mi">89</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="s2">&quot;Sheffield&quot;</span><span class="p">:</span> <span class="mi">269</span><span class="p">},</span>
    <span class="s2">&quot;Manchester&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span> <span class="s2">&quot;Leeds&quot;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span> <span class="s2">&quot;Liverpool&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s2">&quot;Sheffield&quot;</span><span class="p">:</span> <span class="mi">61</span><span class="p">},</span>
    <span class="s2">&quot;Newcastle&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Leeds&quot;</span><span class="p">:</span> <span class="mi">160</span><span class="p">},</span>
    <span class="s2">&quot;Norwich&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Cambridge&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">},</span>
    <span class="s2">&quot;Sheffield&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Birmingham&quot;</span><span class="p">:</span> <span class="mi">119</span><span class="p">,</span> <span class="s2">&quot;Leeds&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;Manchester&quot;</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">:</span> <span class="mi">269</span><span class="p">}</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">city_graph</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>{&#39;Birmingham&#39;: {&#39;Bristol&#39;: 142, &#39;Cambridge&#39;: 162, &#39;Liverpool&#39;: 151, &#39;London&#39;: 189, &#39;Manchester&#39;: 135, &#39;Sheffield&#39;: 119}, &#39;Bristol&#39;: {&#39;Birmingham&#39;: 142, &#39;London&#39;: 190}, &#39;Cambridge&#39;: {&#39;Birmingham&#39;: 162, &#39;Ipswich&#39;: 87, &#39;London&#39;: 89, &#39;Norwich&#39;: 102}, &#39;Ipswich&#39;: {&#39;Cambridge&#39;: 87, &#39;London&#39;: 128, &#39;Norwich&#39;: 70}, &#39;Leeds&#39;: {&#39;Manchester&#39;: 67, &#39;Sheffield&#39;: 56, &#39;Newcastle&#39;: 160}, &#39;Liverpool&#39;: {&#39;Birmingham&#39;: 151, &#39;Manchester&#39;: 55}, &#39;London&#39;: {&#39;Birmingham&#39;: 189, &#39;Bristol&#39;: 190, &#39;Cambridge&#39;: 89, &#39;Ipswich&#39;: 128, &#39;Sheffield&#39;: 269}, &#39;Manchester&#39;: {&#39;Birmingham&#39;: 135, &#39;Leeds&#39;: 67, &#39;Liverpool&#39;: 55, &#39;Sheffield&#39;: 61}, &#39;Newcastle&#39;: {&#39;Leeds&#39;: 160}, &#39;Norwich&#39;: {&#39;Cambridge&#39;: 102, &#39;Ipswich&#39;: 70}, &#39;Sheffield&#39;: {&#39;Birmingham&#39;: 119, &#39;Leeds&#39;: 56, &#39;Manchester&#39;: 61, &#39;London&#39;: 269}}
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b) Implement Three Search Algorithms<a rel="noopener" class="anchor-link" href="#b)-Implement-Three-Search-Algorithms">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Algorithm 1: Depth-First Search (DFS)<a rel="noopener" class="anchor-link" href="#Algorithm-1:-Depth-First-Search-(DFS)">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[129]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Algorithm code</span>
<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">):</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">path</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[130]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Apply to the chosen search problem</span>
<span class="n">path_dfs</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DFS Path:&quot;</span><span class="p">,</span> <span class="n">path_dfs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>DFS Path: [&#39;Ipswich&#39;, &#39;Norwich&#39;, &#39;Cambridge&#39;, &#39;London&#39;, &#39;Sheffield&#39;, &#39;Manchester&#39;, &#39;Leeds&#39;, &#39;Newcastle&#39;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Algorithm 2: Breadth-First Search (BFS)<a rel="noopener" class="anchor-link" href="#Algorithm-2:-Breadth-First-Search-(BFS)">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[131]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Algorithm code</span>
<span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">):</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])])</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
        <span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">path</span>
            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[132]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Apply to the chosen search problem</span>
<span class="n">path_bfs</span> <span class="o">=</span> <span class="n">bfs</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BFS Path:&quot;</span><span class="p">,</span> <span class="n">path_bfs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>BFS Path: [&#39;Ipswich&#39;, &#39;London&#39;, &#39;Sheffield&#39;, &#39;Leeds&#39;, &#39;Newcastle&#39;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Algorithm 3: A* Search<a rel="noopener" class="anchor-link" href="#Algorithm-3:-A*-Search">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[147]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">heuristic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>

    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">a_star</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
   
    <span class="n">priority_queue</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])]</span>  <span class="c1"># (cost, current_node, path)</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    
    <span class="k">while</span> <span class="n">priority_queue</span><span class="p">:</span>
        <span class="n">cost</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">priority_queue</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>
        
        <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span>
        
        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">new_cost</span> <span class="o">=</span> <span class="n">cost</span> <span class="o">-</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span> <span class="o">+</span> <span class="n">weight</span> <span class="o">+</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
                <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">priority_queue</span><span class="p">,</span> <span class="p">(</span><span class="n">new_cost</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>
    
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[148]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Apply to the chosen search problem</span>
<span class="n">path_a_star</span> <span class="o">=</span> <span class="n">a_star</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">,</span> <span class="n">city_coordinates</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A* Path:&quot;</span><span class="p">,</span> <span class="n">path_a_star</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>A* Path: [&#39;Ipswich&#39;, &#39;Norwich&#39;, &#39;Newcastle&#39;]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>c) Compare the Performance of the Algorithms on the Selected Problem<a rel="noopener" class="anchor-link" href="#c)-Compare-the-Performance-of-the-Algorithms-on-the-Selected-Problem">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Algorithms compared based on number of nodes expanded, maximum size of the fringe, and total running time.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[126]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Modify the algorithms to track performance metrics</span>

<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">):</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">nodes_expanded</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">nodes_expanded</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>

        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>

        <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_fringe_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>

<span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">):</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">nodes_expanded</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
        <span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">nodes_expanded</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>

        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>

        <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_fringe_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>

<span class="k">def</span> <span class="nf">heuristic</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">a_star</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
    <span class="n">priority_queue</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])]</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">nodes_expanded</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">priority_queue</span><span class="p">:</span>
        <span class="n">cost</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">priority_queue</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">nodes_expanded</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">vertex</span> <span class="o">==</span> <span class="n">goal</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>

        <span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">new_cost</span> <span class="o">=</span> <span class="n">cost</span> <span class="o">-</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">vertex</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span> <span class="o">+</span> <span class="n">weight</span> <span class="o">+</span> <span class="n">heuristic</span><span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
                <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">priority_queue</span><span class="p">,</span> <span class="p">(</span><span class="n">new_cost</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>

        <span class="n">max_fringe_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_fringe_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">priority_queue</span><span class="p">))</span>

    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">nodes_expanded</span><span class="p">,</span> <span class="n">max_fringe_size</span>    
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[124]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Run algorithms and collect performance metrics</span>

<span class="c1"># DFS</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">path_dfs</span><span class="p">,</span> <span class="n">nodes_dfs</span><span class="p">,</span> <span class="n">fringe_dfs</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">)</span>
<span class="n">dfs_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># BFS</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">path_bfs</span><span class="p">,</span> <span class="n">nodes_bfs</span><span class="p">,</span> <span class="n">fringe_bfs</span> <span class="o">=</span> <span class="n">bfs</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">)</span>
<span class="n">bfs_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># A*</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">path_a_star</span><span class="p">,</span> <span class="n">nodes_a_star</span><span class="p">,</span> <span class="n">fringe_a_star</span> <span class="o">=</span> <span class="n">a_star</span><span class="p">(</span><span class="n">city_graph</span><span class="p">,</span> <span class="s2">&quot;Ipswich&quot;</span><span class="p">,</span> <span class="s2">&quot;Newcastle&quot;</span><span class="p">,</span> <span class="n">city_coordinates</span><span class="p">)</span>
<span class="n">a_star_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[125]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Compare performance of the algorithms</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Algorithm&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DFS&quot;</span><span class="p">,</span> <span class="s2">&quot;BFS&quot;</span><span class="p">,</span> <span class="s2">&quot;A*&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Path&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">path_dfs</span><span class="p">,</span> <span class="n">path_bfs</span><span class="p">,</span> <span class="n">path_a_star</span><span class="p">],</span>
    <span class="s2">&quot;Nodes Expanded&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">nodes_dfs</span><span class="p">,</span> <span class="n">nodes_bfs</span><span class="p">,</span> <span class="n">nodes_a_star</span><span class="p">],</span>
    <span class="s2">&quot;Max Fringe Size&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">fringe_dfs</span><span class="p">,</span> <span class="n">fringe_bfs</span><span class="p">,</span> <span class="n">fringe_a_star</span><span class="p">],</span>
    <span class="s2">&quot;Running Time (s)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">dfs_time</span><span class="p">,</span> <span class="n">bfs_time</span><span class="p">,</span> <span class="n">a_star_time</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>  Algorithm                             Path  Nodes Expanded  Max Fringe Size  \
0       DFS  [Ipswich, Cambridge, Newcastle]               3                2   
1       BFS    [Ipswich, Norwich, Newcastle]               4                2   
2        A*    [Ipswich, Norwich, Newcastle]               4                2   

   Running Time (s)  
0          0.000000  
1          0.005009  
2          0.001233  
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>2) Task 2: Bayesian Networks<a rel="noopener" class="anchor-link" href="#2)-Task-2:-Bayesian-Networks">&#182;</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pgmpy
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Requirement already satisfied: pgmpy in c:\users\adsal\anaconda3\lib\site-packages (0.1.25)
Requirement already satisfied: networkx in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (3.2.1)
Requirement already satisfied: numpy in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (1.26.4)
Requirement already satisfied: scipy in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (1.13.1)
Requirement already satisfied: scikit-learn in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (1.5.0)
Requirement already satisfied: pandas in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (2.1.4)
Requirement already satisfied: pyparsing in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (3.0.9)
Requirement already satisfied: torch in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (2.3.1)
Requirement already satisfied: statsmodels in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (0.14.2)
Requirement already satisfied: tqdm in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (4.65.0)
Requirement already satisfied: joblib in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (1.4.2)
Requirement already satisfied: opt-einsum in c:\users\adsal\anaconda3\lib\site-packages (from pgmpy) (3.3.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\adsal\anaconda3\lib\site-packages (from pandas-&gt;pgmpy) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\adsal\anaconda3\lib\site-packages (from pandas-&gt;pgmpy) (2023.3.post1)
Requirement already satisfied: tzdata&gt;=2022.1 in c:\users\adsal\anaconda3\lib\site-packages (from pandas-&gt;pgmpy) (2023.3)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in c:\users\adsal\anaconda3\lib\site-packages (from scikit-learn-&gt;pgmpy) (3.5.0)
Requirement already satisfied: patsy&gt;=0.5.6 in c:\users\adsal\anaconda3\lib\site-packages (from statsmodels-&gt;pgmpy) (0.5.6)
Requirement already satisfied: packaging&gt;=21.3 in c:\users\adsal\anaconda3\lib\site-packages (from statsmodels-&gt;pgmpy) (23.1)
Requirement already satisfied: filelock in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (3.13.1)
Requirement already satisfied: typing-extensions&gt;=4.8.0 in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (4.9.0)
Requirement already satisfied: sympy in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (1.12.1)
Requirement already satisfied: jinja2 in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (3.1.3)
Requirement already satisfied: fsspec in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (2023.10.0)
Requirement already satisfied: mkl&lt;=2021.4.0,&gt;=2021.1.1 in c:\users\adsal\anaconda3\lib\site-packages (from torch-&gt;pgmpy) (2021.4.0)
Requirement already satisfied: colorama in c:\users\adsal\anaconda3\lib\site-packages (from tqdm-&gt;pgmpy) (0.4.6)
Requirement already satisfied: intel-openmp==2021.* in c:\users\adsal\anaconda3\lib\site-packages (from mkl&lt;=2021.4.0,&gt;=2021.1.1-&gt;torch-&gt;pgmpy) (2021.4.0)
Requirement already satisfied: tbb==2021.* in c:\users\adsal\anaconda3\lib\site-packages (from mkl&lt;=2021.4.0,&gt;=2021.1.1-&gt;torch-&gt;pgmpy) (2021.12.0)
Requirement already satisfied: six in c:\users\adsal\anaconda3\lib\site-packages (from patsy&gt;=0.5.6-&gt;statsmodels-&gt;pgmpy) (1.16.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in c:\users\adsal\anaconda3\lib\site-packages (from jinja2-&gt;torch-&gt;pgmpy) (2.1.3)
Requirement already satisfied: mpmath&lt;1.4.0,&gt;=1.1.0 in c:\users\adsal\anaconda3\lib\site-packages (from sympy-&gt;torch-&gt;pgmpy) (1.3.0)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>2.1 Create the Bayesian network:<a rel="noopener" class="anchor-link" href="#2.1-Create-the-Bayesian-network:">&#182;</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Importing the necessary libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">PC</span><span class="p">,</span> <span class="n">HillClimbSearch</span><span class="p">,</span> <span class="n">K2Score</span><span class="p">,</span> <span class="n">BicScore</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">,</span> <span class="n">BayesianEstimator</span>
<span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>


<span class="c1"># Define the structure of the Bayesian network</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">),</span> 
                                  <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> 
                                  <span class="p">(</span><span class="s1">&#39;Residence&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span>
                                  <span class="p">(</span><span class="s1">&#39;Occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)])</span>

<span class="c1"># Load the travel survey data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Travel_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the data</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[59]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Age</th>
<th>Residence</th>
<th>Education</th>
<th>Occupation</th>
<th>Sex</th>
<th>Travel</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>adult</td>
<td>big</td>
<td>uni</td>
<td>emp</td>
<td>M</td>
<td>car</td>
</tr>
<tr>
<th>1</th>
<td>young</td>
<td>big</td>
<td>high</td>
<td>emp</td>
<td>M</td>
<td>train</td>
</tr>
<tr>
<th>2</th>
<td>young</td>
<td>small</td>
<td>high</td>
<td>emp</td>
<td>F</td>
<td>car</td>
</tr>
<tr>
<th>3</th>
<td>old</td>
<td>big</td>
<td>high</td>
<td>emp</td>
<td>F</td>
<td>car</td>
</tr>
<tr>
<th>4</th>
<td>adult</td>
<td>big</td>
<td>high</td>
<td>emp</td>
<td>M</td>
<td>car</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a. Write code to build the Bayesian network as shown in Figure 1.<a rel="noopener" class="anchor-link" href="#a.-Write-code-to-build-the-Bayesian-network-as-shown-in-Figure-1.">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize a BayesianNetwork object</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>

<span class="c1"># Extract nodes and edges from the Bayesian model</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="c1"># Create a NetworkX graph</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="c1"># Add nodes to the graph</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

<span class="c1"># Add edges to the graph</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b. Visualise the resulting network structure using the network package.<a rel="noopener" class="anchor-link" href="#b.-Visualise-the-resulting-network-structure-using-the-network-package.">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Visualize the network structure</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Bayesian Network Structure&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" src="javascript://"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>2.2 Learn the network structure from the data:<a rel="noopener" class="anchor-link" href="#2.2-Learn-the-network-structure-from-the-data:">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>a. Use of Peter and Clark (PC) algorithm to estimate the structure of the Bayesian network based on the travel survey data.<a rel="noopener" class="anchor-link" href="#a.-Use-of-Peter-and-Clark-(PC)-algorithm-to-estimate-the-structure-of-the-Bayesian-network-based-on-the-travel-survey-data.">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Instantiate the PC algorithm object</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Estimate the structure of the Bayesian network</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>

<span class="c1"># Visualize the learned structure</span>
<span class="nb">print</span><span class="p">(</span><span class="n">estimated_model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Working for n conditional variables: 2:  40%|█████████████████▌                          | 2/5 [00:00&lt;00:00,  3.93it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>[(&#39;Sex&#39;, &#39;Education&#39;)]
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b. Compare the learned model structure to the expert-based one<a rel="noopener" class="anchor-link" href="#b.-Compare-the-learned-model-structure-to-the-expert-based-one">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define the expert-based model structure (example)</span>
<span class="n">expert_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Define the learned model structure (example)</span>
<span class="n">learned_edges</span> <span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Create directed graphs for both structures</span>
<span class="n">expert_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">expert_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span>

<span class="n">learned_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">learned_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">)</span>

<span class="c1"># Plot expert-based model structure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">pos_expert</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">expert_graph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Adjust k to add space between nodes</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">expert_graph</span><span class="p">,</span> <span class="n">pos_expert</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Expert-Based Model Structure&quot;</span><span class="p">)</span>

<span class="c1"># Plot learned model structure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">pos_learned</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">learned_graph</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Adjust k to add space between nodes</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">learned_graph</span><span class="p">,</span> <span class="n">pos_learned</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Learned Model Structure&quot;</span><span class="p">)</span>

<span class="c1"># Show plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compare edges between expert-based and learned model structures</span>
<span class="n">matching_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">))</span>
<span class="n">mismatching_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matching Edges (Expert-Based and Learned Model):&quot;</span><span class="p">,</span> <span class="n">matching_edges</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mismatching Edges (Expert-Based vs Learned Model):&quot;</span><span class="p">,</span> <span class="n">mismatching_edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" src="javascript://"/>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Matching Edges (Expert-Based and Learned Model): {(&#39;Sex&#39;, &#39;Travel&#39;), (&#39;Education&#39;, &#39;Occupation&#39;), (&#39;Age&#39;, &#39;Residence&#39;)}
Mismatching Edges (Expert-Based vs Learned Model): set()
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>c. Evaluate the learned structure using the F1-score.<a rel="noopener" class="anchor-link" href="#c.-Evaluate-the-learned-structure-using-the-F1-score.">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define the expert-based model structure (example)</span>
<span class="n">expert_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Define the learned model structure (example)</span>
<span class="n">learned_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Create directed graphs for both structures</span>
<span class="n">expert_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">expert_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span>

<span class="n">learned_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">learned_graph</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">)</span>

<span class="c1"># Plot expert-based model structure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">expert_graph</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">expert_graph</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Expert-Based Model Structure&quot;</span><span class="p">)</span>

<span class="c1"># Plot learned model structure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">learned_graph</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">learned_graph</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Learned Model Structure&quot;</span><span class="p">)</span>

<span class="c1"># Show plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compare edges between expert-based and learned model structures</span>
<span class="n">expert_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span>
<span class="n">learned_edges_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">)</span>

<span class="n">true_positives</span> <span class="o">=</span> <span class="n">expert_edges_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">learned_edges_set</span><span class="p">)</span>
<span class="n">false_positives</span> <span class="o">=</span> <span class="n">learned_edges_set</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">expert_edges_set</span><span class="p">)</span>
<span class="n">false_negatives</span> <span class="o">=</span> <span class="n">expert_edges_set</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">learned_edges_set</span><span class="p">)</span>

<span class="n">TP</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">true_positives</span><span class="p">)</span>
<span class="n">FP</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">false_positives</span><span class="p">)</span>
<span class="n">FN</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">false_negatives</span><span class="p">)</span>

<span class="c1"># Calculate precision, recall, and F1-score</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">FP</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">FP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">FN</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">TP</span> <span class="o">+</span> <span class="n">FN</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
<span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True Positives (TP):&quot;</span><span class="p">,</span> <span class="n">TP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;False Positives (FP):&quot;</span><span class="p">,</span> <span class="n">FP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;False Negatives (FN):&quot;</span><span class="p">,</span> <span class="n">FN</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision:&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall:&quot;</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-Score:&quot;</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" src="javascript://"/>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>True Positives (TP): 3
False Positives (FP): 0
False Negatives (FN): 0
Precision: 1.0
Recall: 1.0
F1-Score: 1.0
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>2.3 Learn the parameters of the Bayesian network from the data<a rel="noopener" class="anchor-link" href="#2.3-Learn-the-parameters-of-the-Bayesian-network-from-the-data">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a. Estimate the conditional probability tables (CPTs) of all nodes in the expert-based Bayesian network.<a rel="noopener" class="anchor-link" href="#a.-Estimate-the-conditional-probability-tables-(CPTs)-of-all-nodes-in-the-expert-based-Bayesian-network.">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the travel survey data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;travel_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Define the expert-based model structure</span>
<span class="n">expert_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Create a Bayesian network with the expert-based structure</span>
<span class="n">expert_bn</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span>

<span class="c1"># Learn the parameters (CPTs) of the Bayesian network from the data</span>
<span class="c1"># Using Maximum Likelihood Estimation (MLE)</span>
<span class="n">expert_bn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">MaximumLikelihoodEstimator</span><span class="p">)</span>

<span class="c1"># Display the learned CPTs for each node</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">expert_bn</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node: </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">expert_bn</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Node: Age
+------------+-------+
| Age(adult) | 0.472 |
+------------+-------+
| Age(old)   | 0.208 |
+------------+-------+
| Age(young) | 0.32  |
+------------+-------+


Node: Residence
+------------------+--------------------+---------------------+------------+
| Age              | Age(adult)         | Age(old)            | Age(young) |
+------------------+--------------------+---------------------+------------+
| Residence(big)   | 0.7542372881355932 | 0.6538461538461539  | 0.83125    |
+------------------+--------------------+---------------------+------------+
| Residence(small) | 0.2457627118644068 | 0.34615384615384615 | 0.16875    |
+------------------+--------------------+---------------------+------------+


Node: Education
+-----------------+------+
| Education(high) | 0.73 |
+-----------------+------+
| Education(uni)  | 0.27 |
+-----------------+------+


Node: Occupation
+------------------+----------------------+---------------------+
| Education        | Education(high)      | Education(uni)      |
+------------------+----------------------+---------------------+
| Occupation(emp)  | 0.9808219178082191   | 0.9259259259259259  |
+------------------+----------------------+---------------------+
| Occupation(self) | 0.019178082191780823 | 0.07407407407407407 |
+------------------+----------------------+---------------------+


Node: Sex
+--------+-------+
| Sex(F) | 0.402 |
+--------+-------+
| Sex(M) | 0.598 |
+--------+-------+


Node: Travel
+---------------+---------------------+---------------------+
| Sex           | Sex(F)              | Sex(M)              |
+---------------+---------------------+---------------------+
| Travel(car)   | 0.5920398009950248  | 0.5719063545150501  |
+---------------+---------------------+---------------------+
| Travel(other) | 0.19900497512437812 | 0.1505016722408027  |
+---------------+---------------------+---------------------+
| Travel(train) | 0.208955223880597   | 0.27759197324414714 |
+---------------+---------------------+---------------------+


</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>2.4 Inference<a rel="noopener" class="anchor-link" href="#2.4-Inference">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>a. Use the expert-based Bayesian network with the learned CPTs to answer a few interesting queries<a rel="noopener" class="anchor-link" href="#a.-Use-the-expert-based-Bayesian-network-with-the-learned-CPTs-to-answer-a-few-interesting-queries">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the travel survey data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;travel_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Convert categorical variables to integers</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">codes</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Education&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">codes</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">codes</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Residence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Residence&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">codes</span>

<span class="c1"># Define the expert-based model structure</span>
<span class="n">expert_edges</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">)]</span>

<span class="c1"># Create a Bayesian network with the expert-based structure</span>
<span class="n">expert_bn</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">(</span><span class="n">expert_edges</span><span class="p">)</span>

<span class="c1"># Learn the parameters (CPTs) of the Bayesian network from the data</span>
<span class="c1"># Using Maximum Likelihood Estimation (MLE)</span>
<span class="n">expert_bn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">MaximumLikelihoodEstimator</span><span class="p">)</span>

<span class="c1"># Create an inference object for the Bayesian network</span>
<span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">expert_bn</span><span class="p">)</span>

<span class="c1"># Define some queries to answer</span>

<span class="c1"># Differences between age groups in the usage of travel modes</span>
<span class="n">age_groups</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">for</span> <span class="n">age</span> <span class="ow">in</span> <span class="n">age_groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Travel mode given Age = </span><span class="si">{</span><span class="n">age</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="n">age</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Differences between females and males in the usage of travel modes</span>
<span class="n">sex_groups</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">for</span> <span class="n">sex</span> <span class="ow">in</span> <span class="n">sex_groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Travel mode given Sex = </span><span class="si">{</span><span class="n">sex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="n">sex</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Predicting the most likely preferred mode of travel for a specific individual profile</span>
<span class="c1"># Define the profile with integer values</span>
<span class="n">profile</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="s1">&#39;30-40&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">:</span> <span class="s1">&#39;Bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">:</span> <span class="s1">&#39;Urban&#39;</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Most likely travel mode for profile </span><span class="si">{</span><span class="n">profile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convert profile values from string representations to integer codes</span>
<span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_value</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">profile</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="n">var_value</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="n">profile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Query: Travel mode given Age = 0
+---------------+---------------+
| Travel        |   phi(Travel) |
+===============+===============+
| Travel(car)   |        0.5800 |
+---------------+---------------+
| Travel(other) |        0.1700 |
+---------------+---------------+
| Travel(train) |        0.2500 |
+---------------+---------------+


Query: Travel mode given Age = 2
+---------------+---------------+
| Travel        |   phi(Travel) |
+===============+===============+
| Travel(car)   |        0.5800 |
+---------------+---------------+
| Travel(other) |        0.1700 |
+---------------+---------------+
| Travel(train) |        0.2500 |
+---------------+---------------+


Query: Travel mode given Age = 1
+---------------+---------------+
| Travel        |   phi(Travel) |
+===============+===============+
| Travel(car)   |        0.5800 |
+---------------+---------------+
| Travel(other) |        0.1700 |
+---------------+---------------+
| Travel(train) |        0.2500 |
+---------------+---------------+


Query: Travel mode given Sex = 1
+---------------+---------------+
| Travel        |   phi(Travel) |
+===============+===============+
| Travel(car)   |        0.5719 |
+---------------+---------------+
| Travel(other) |        0.1505 |
+---------------+---------------+
| Travel(train) |        0.2776 |
+---------------+---------------+


Query: Travel mode given Sex = 0
+---------------+---------------+
| Travel        |   phi(Travel) |
+===============+===============+
| Travel(car)   |        0.5920 |
+---------------+---------------+
| Travel(other) |        0.1990 |
+---------------+---------------+
| Travel(train) |        0.2090 |
+---------------+---------------+


Query: Most likely travel mode for profile {&#39;Age&#39;: &#39;30-40&#39;, &#39;Education&#39;: &#39;Bachelor&#39;, &#39;Sex&#39;: &#39;Female&#39;, &#39;Residence&#39;: &#39;Urban&#39;}
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Finding Elimination Order: : : 0it [00:00, ?it/s]
0it [00:00, ?it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>{&#39;Travel&#39;: &#39;car&#39;}


</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>b. Run the same queries using the Bayesian network<a rel="noopener" class="anchor-link" href="#b.-Run-the-same-queries-using-the-Bayesian-network">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the travel survey data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;travel_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Convert relevant columns to categorical type (if not already done)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">]:</span>
    <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># Define the structure of the learned Bayesian Network</span>
<span class="n">learned_edges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupation&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Create the Bayesian Network</span>
<span class="n">learned_bn</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">(</span><span class="n">learned_edges</span><span class="p">)</span>

<span class="c1"># Estimate the parameters (CPTs) using Maximum Likelihood Estimation</span>
<span class="n">learned_bn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">MaximumLikelihoodEstimator</span><span class="p">)</span>

<span class="c1"># Perform inference</span>
<span class="n">learned_inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">learned_bn</span><span class="p">)</span>

<span class="c1"># Define travel mode mapping</span>
<span class="n">travel_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;train&#39;</span>
<span class="p">}</span>

<span class="c1"># Queries</span>
<span class="k">def</span> <span class="nf">query_travel_mode_by_age</span><span class="p">(</span><span class="n">age_category</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Travel mode given Age = </span><span class="si">{</span><span class="s1">&#39;adult&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">age_category</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
        <span class="c1"># Execute the query with the category name as evidence</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">learned_inference</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="n">age_category</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">travel_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Age category not found in the data.&quot;</span><span class="p">)</span>

<span class="c1"># Define the queries</span>
<span class="n">age_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Adult&#39;</span><span class="p">,</span> <span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">age_category</span> <span class="ow">in</span> <span class="n">age_categories</span><span class="p">:</span>
    <span class="n">query_travel_mode_by_age</span><span class="p">(</span><span class="n">age_category</span><span class="p">)</span>

<span class="c1"># Query: Travel mode given Sex = &#39;M&#39; or &#39;F&#39;</span>
<span class="k">def</span> <span class="nf">query_travel_mode_by_sex</span><span class="p">(</span><span class="n">sex_category</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Travel mode given Sex = </span><span class="si">{</span><span class="n">sex_category</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sex_category</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
        <span class="c1"># Execute the query with the category name as evidence</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">learned_inference</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="n">sex_category</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">travel_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Sex category not found in the data.&quot;</span><span class="p">)</span>

<span class="c1"># Define the queries</span>
<span class="n">sex_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">sex_category</span> <span class="ow">in</span> <span class="n">sex_categories</span><span class="p">:</span>
    <span class="n">query_travel_mode_by_sex</span><span class="p">(</span><span class="n">sex_category</span><span class="p">)</span>

<span class="c1"># Query: Most likely travel mode for a specific individual profile</span>
<span class="n">profile</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="s1">&#39;30-40&#39;</span><span class="p">,</span> <span class="s1">&#39;Education&#39;</span><span class="p">:</span> <span class="s1">&#39;Bachelor&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Residence&#39;</span><span class="p">:</span> <span class="s1">&#39;Urban&#39;</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: Most likely travel mode for profile </span><span class="si">{</span><span class="n">profile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convert profile values from string representations to integer codes</span>
<span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_value</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">profile</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="n">var_value</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">learned_inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="n">profile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
WARNING:pgmpy:Found unknown state name. Trying to switch to using all state names as state numbers
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Query: Travel mode given Age = adult
Error: Age category not found in the data.
Query: Travel mode given Age = adult
car: 0.5628
bus: 0.1871
train: 0.2501


Query: Travel mode given Age = adult
car: 0.5819
bus: 0.1538
train: 0.2642


Query: Travel mode given Sex = M
car: 0.5727
bus: 0.1505
train: 0.2769


Query: Travel mode given Sex = F
car: 0.5936
bus: 0.1984
train: 0.2080


Query: Most likely travel mode for profile {&#39;Age&#39;: &#39;30-40&#39;, &#39;Education&#39;: &#39;Bachelor&#39;, &#39;Sex&#39;: &#39;Female&#39;, &#39;Residence&#39;: &#39;Urban&#39;}
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Finding Elimination Order: : : 0it [00:00, ?it/s]
0it [00:00, ?it/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>{&#39;Travel&#39;: &#39;car&#39;}


</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>c. Determine which Bayesian network, expert-based or estimated, leads to the most accurate predictions of the favourite mode of travel<a rel="noopener" class="anchor-link" href="#c.-Determine-which-Bayesian-network,-expert-based-or-estimated,-leads-to-the-most-accurate-predictions-of-the-favourite-mode-of-travel">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to predict the travel mode using the Bayesian network</span>
<span class="k">def</span> <span class="nf">predict_travel_mode</span><span class="p">(</span><span class="n">inference</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
    <span class="n">evidence</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Travel&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="n">predicted_mode</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="n">evidence</span><span class="p">)[</span><span class="s1">&#39;Travel&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">predicted_mode</span>

<span class="c1"># Predict using the expert-based Bayesian network</span>
<span class="n">expert_predictions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">predict_travel_mode</span><span class="p">(</span><span class="n">expert_inference</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Predict using the learned Bayesian network</span>
<span class="n">learned_predictions</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">predict_travel_mode</span><span class="p">(</span><span class="n">learned_inference</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Map predictions back to original categories if needed</span>
<span class="n">expert_predictions</span> <span class="o">=</span> <span class="n">expert_predictions</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">travel_inverse_mapping</span><span class="p">)</span>
<span class="n">learned_predictions</span> <span class="o">=</span> <span class="n">learned_predictions</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">travel_inverse_mapping</span><span class="p">)</span>

<span class="c1"># Calculate the accuracy for each network</span>
<span class="n">expert_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">expert_predictions</span><span class="p">)</span>
<span class="n">learned_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Travel&#39;</span><span class="p">],</span> <span class="n">learned_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy of Expert-Based Bayesian Network: </span><span class="si">{</span><span class="n">expert_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy of Learned Bayesian Network: </span><span class="si">{</span><span class="n">learned_accuracy</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>3) Task 3: Machine Learning<a rel="noopener" class="anchor-link" href="#3)-Task-3:-Machine-Learning">&#182;</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[151]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Add the necessary packages for Task 3 in this cell</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>


<span class="c1"># Load the datasets</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_train.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_test.csv&#39;</span><span class="p">)</span>

<span class="c1"># Display the first few rows of the training data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>                                                text sentiment
0  Yeh! SO happy now. Chrome works on WIndows 7 x64   positive
1             doing science homework in the com lab   negative
2  7:00 am on saturday morning &amp;amp; i&#39;m about to...  positive
3  woo! gosh, its hot here too! But there were po...  positive
4  @sarahmonline It&#39;ll be great if David&#39;s on Cam...  positive
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the datasets</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_train.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_test.csv&#39;</span><span class="p">)</span>

<span class="c1"># Function to clean the text</span>
<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># Remove HTML tags</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># Remove special characters</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Convert to lowercase</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># Apply the cleaning function to the text column</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_text</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_text</span><span class="p">)</span>

<span class="c1"># Initialize CountVectorizer with max_features=3000</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>

<span class="c1"># Fit and transform the text data to create the document-term matrix</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="c1"># Get the labels</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span>

<span class="c1"># Splitting train data for validation purposes</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Display the shapes of the resulting matrices</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_train shape: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_val shape: </span><span class="si">{</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_test shape: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>X_train shape: (160000, 3000)
X_val shape: (40000, 3000)
X_test shape: (20000, 3000)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>3.1. Preprocess the data<a rel="noopener" class="anchor-link" href="#3.1.-Preprocess-the-data">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the datasets</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_train.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;twitter_test.csv&#39;</span><span class="p">)</span>

<span class="c1"># Function to clean the text</span>
<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># Remove HTML tags</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># Remove special characters</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="c1"># Convert to lowercase</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># Apply the cleaning function to the text column</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_text</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_text</span><span class="p">)</span>

<span class="c1"># Initialize CountVectorizer with max_features=3000</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>

<span class="c1"># Fit and transform the text data to create the document-term matrix</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="c1"># Get the labels</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span>

<span class="c1"># Splitting train data for validation purposes</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Display the shapes of the resulting matrices</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_train shape: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_val shape: </span><span class="si">{</span><span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;X_test shape: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>X_train shape: (160000, 3000)
X_val shape: (40000, 3000)
X_test shape: (20000, 3000)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>3.2. Build a Naive Bayes Model<a rel="noopener" class="anchor-link" href="#3.2.-Build-a-Naive-Bayes-Model">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize the Naive Bayes model</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>

<span class="c1"># Set up the parameter grid for GridSearchCV</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># Smoothing parameter</span>
<span class="p">}</span>

<span class="c1"># Initialize GridSearchCV</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">nb</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>

<span class="c1"># Fit the model on the training data</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Get the best model from grid search</span>
<span class="n">best_nb</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="c1"># Predict on the validation set</span>
<span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">best_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

<span class="c1"># Evaluate the model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="c1"># Display the evaluation metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation F1 Score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Validation Accuracy: 0.7453
Validation Precision: 0.7562
Validation Recall: 0.7309
Validation F1 Score: 0.7433
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>3.3. Evaluate the Resulting Model<a rel="noopener" class="anchor-link" href="#3.3.-Evaluate-the-Resulting-Model">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[112]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Predict on the test set using the best Naive Bayes model</span>
<span class="n">y_test_pred_nb</span> <span class="o">=</span> <span class="n">best_nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Evaluate the Naive Bayes model on the test set</span>
<span class="n">accuracy_nb</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_nb</span><span class="p">)</span>
<span class="n">precision_nb</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_nb</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">recall_nb</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_nb</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">f1_nb</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_nb</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="c1"># Display the evaluation metrics for the Naive Bayes model</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Accuracy (Naive Bayes): </span><span class="si">{</span><span class="n">accuracy_nb</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Precision (Naive Bayes): </span><span class="si">{</span><span class="n">precision_nb</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Recall (Naive Bayes): </span><span class="si">{</span><span class="n">recall_nb</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test F1 Score (Naive Bayes): </span><span class="si">{</span><span class="n">f1_nb</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Test Accuracy (Naive Bayes): 0.7498
Test Precision (Naive Bayes): 0.7543
Test Recall (Naive Bayes): 0.7410
Test F1 Score (Naive Bayes): 0.7476
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>3.4. Run Another Machine Learning Algorithm<a rel="noopener" class="anchor-link" href="#3.4.-Run-Another-Machine-Learning-Algorithm">&#182;</a></h3>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize the Logistic Regression model</span>
<span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Train the Logistic Regression model on the training data</span>
<span class="n">log_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict on the validation set using the Logistic Regression model</span>
<span class="n">y_val_pred_lr</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

<span class="c1"># Evaluate the Logistic Regression model on the validation set</span>
<span class="n">accuracy_lr</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_lr</span><span class="p">)</span>
<span class="n">precision_lr</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">recall_lr</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">f1_lr</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_val_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="c1"># Display the evaluation metrics for the Logistic Regression model on the validation set</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Accuracy (Logistic Regression): </span><span class="si">{</span><span class="n">accuracy_lr</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Precision (Logistic Regression): </span><span class="si">{</span><span class="n">precision_lr</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation Recall (Logistic Regression): </span><span class="si">{</span><span class="n">recall_lr</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Validation F1 Score (Logistic Regression): </span><span class="si">{</span><span class="n">f1_lr</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Predict on the test set using the Logistic Regression model</span>
<span class="n">y_test_pred_lr</span> <span class="o">=</span> <span class="n">log_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Evaluate the Logistic Regression model on the test set</span>
<span class="n">accuracy_lr_test</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_lr</span><span class="p">)</span>
<span class="n">precision_lr_test</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">recall_lr_test</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
<span class="n">f1_lr_test</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_lr</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>

<span class="c1"># Display the evaluation metrics for the Logistic Regression model on the test set</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Accuracy (Logistic Regression): </span><span class="si">{</span><span class="n">accuracy_lr_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Precision (Logistic Regression): </span><span class="si">{</span><span class="n">precision_lr_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test Recall (Logistic Regression): </span><span class="si">{</span><span class="n">recall_lr_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test F1 Score (Logistic Regression): </span><span class="si">{</span><span class="n">f1_lr_test</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Validation Accuracy (Logistic Regression): 0.7528
Validation Precision (Logistic Regression): 0.7398
Validation Recall (Logistic Regression): 0.7865
Validation F1 Score (Logistic Regression): 0.7624
Test Accuracy (Logistic Regression): 0.7600
Test Precision (Logistic Regression): 0.7388
Test Recall (Logistic Regression): 0.8043
Test F1 Score (Logistic Regression): 0.7701
</pre>
</div>
</div>
</div>
</div>
</div>
</main>


<script type="module" src="https://s.brightspace.com/lib/bsi/2024.9.248/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
						if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
							document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
								elm.setAttribute('style', 'display: block; height: 0.5rem;');
							});

							window.D2L.MathJax.loadMathJax({
								outputScale: 1.5,
								renderLatex: true,
								enableMML3Support: false
							});
						}
					});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.9.248/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.9.248/unbundled/embeds.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					window.D2L.EmbedRenderer.renderEmbeds(document.body);
				});</script></body></html>